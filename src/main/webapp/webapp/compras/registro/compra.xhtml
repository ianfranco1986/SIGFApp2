<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <ui:composition>

        <p:dialog id="CompraCreateDlg" widgetVar="CompraCreateDialog" header="Registro | Compras" modal="true" resizable="false" appendTo="@(body)" closeOnEscape="true" width="75%">
            <h:form id="CompraCreateForm">
                <div class="p-grid" style="padding-left: 10px">

                    <div class="p-col-12">
                        <div class="ui-fluid p-formgrid p-grid">
                            <div class="p-field p-col-12 p-md-4">
                                <label>Proveedor</label>
                                <p:inputNumber id="folionn" decimalPlaces="0"  tabindex="8" />
                            </div>
                            <div class="p-field p-col-12 p-md-3">
                                <label>T.Documento</label>
                                <p:selectOneMenu id="compraTipoDocumentoId" tabindex="5" value="#{compraController.tipoDocumento}" required="true" requiredMessage="Debe seleccionar el tipo de documento" converter="omnifaces.SelectItemsConverter" filter="true" filterMatchMode="contains">
                                    <f:selectItem itemLabel="Tipo de Documento"/>
                                    <f:selectItems value="#{compraController.tipoDocumentoItems}"
                                                   var="compraTipoDocumentoIdItem"
                                                   itemValue="#{compraTipoDocumentoIdItem}"
                                                   itemLabel="#{compraTipoDocumentoIdItem.tipoDocumentoNombre}"
                                                   />
                                </p:selectOneMenu>               
                            </div>
                            <div class="p-field p-col-12 p-md-1">
                                <label>Anulado</label>
                                <p:selectBooleanCheckbox id="anulado" value="#{selectBooleanView.value1}" itemLabel=""/>
                            </div>
                            <div class="p-field p-col-12 p-md-4">
                                <label>Folio</label>
                                <p:inputNumber id="folion" decimalPlaces="0"  tabindex="8" />
                            </div>
                        </div>
                    </div>




                    <div class="p-col-4">
                        <div class="ui-fluid p-formgrid p-grid">
                            <div class="p-field p-col-12 p-md-4">
                                <label>F. Acuse</label>
                                <p:datePicker id="acuse3" tabindex="1" placeholder="F.Acuse" showButtonBar="true" triggerButtonIcon="true" />
                            </div>
                            <div class="p-field p-col-12 p-md-4">
                                <label>F.Documento</label>
                                <p:datePicker id="fecha3" type="text"  tabindex="2" placeholder="F.Documento" showButtonBar="true" />
                            </div>
                            <div class="p-field p-col-12 p-md-4">
                                <label>F.Recepción</label>
                                <p:datePicker id="recepcion3"  tabindex="3" placeholder="F.Recepción" showButtonBar="true" />
                            </div>
                        </div>
                    </div>
                    <div class="p-col-8">
                        <div class="ui-fluid p-formgrid p-grid">
                            <div class="p-field p-col-12">
                                <label>Descripción</label>
                                <p:inputText  placeholder="Glosa" tabindex="7" />
                            </div>
                        </div>                        
                    </div>

                    <p:divider align="right" >
                        <b>Detalle</b>
                    </p:divider>

                    <div class="p-col-4">
                        <div class="ui-fluid p-formgrid p-grid">
                            <div class="p-field p-col-12">
                                <label>Cuenta</label>
                                <p:autoComplete id="cuenta2" 

                                                converter="cuentaMayorConverter" 
                                                completeMethod="#{edicionComprasController.completeText}" 
                                                var="country" 
                                                itemLabel="#{country.cuentaMayorNombre}" 
                                                itemValue="#{country}"
                                                required="true"
                                                forceSelection="true" 
                                                scrollHeight="250"
                                                > 
                                </p:autoComplete>                            
                            </div>
                        </div>

                    </div>
                    <div class="p-col-4">
                        <div class="ui-fluid p-formgrid p-grid">
                            <div class="p-field p-col-12">
                                <label>C.Costo</label>
                                <p:autoComplete id="centrocosto" 

                                                converter="cuentaMayorConverter" 
                                                completeMethod="#{edicionComprasController.completeText}" 
                                                var="country" 
                                                itemLabel="#{country.cuentaMayorNombre}" 
                                                itemValue="#{country}"
                                                required="true"
                                                forceSelection="true" 
                                                scrollHeight="250"
                                                > 
                                </p:autoComplete>                            
                            </div>
                        </div>

                    </div>
                    <div class="p-col-2">
                        <div class="ui-fluid p-formgrid p-grid">
                            <div class="p-field p-col-12">
                                <label>Monto</label>
                                <p:inputNumber id="neto" decimalPlaces="0"  tabindex="8" />
                            </div>
                        </div>
                    </div>
                    <div class="p-col-2">
                        <div class="ui-fluid p-formgrid p-grid">
                            <div class="p-field p-col-12">
                                <label>Agregar</label>
                                <p:commandButton value="" icon="pi pi-plus"/>
                            </div>
                        </div>
                        
                    </div>

                    <div class="p-col-9">

                        <div class="p-col-12">
                            <div class="p-col-11">
                                <div class="ui-fluid p-formgrid p-grid">

                                </div>
                                <div class="ui-fluid p-formgrid p-grid">
                                    <div class="p-field p-col-12 p-md-4">
                                        <label>N° Documento</label>
                                        <p:inputText id="zip" type="text" autocomplete="off"  tabindex="4" placeholder="N° de Docto."/>
                                    </div>
                                    <div class="p-field p-col-12 p-md-1">
                                        <label style="visibility: hidden;">Buscar</label>
                                        <p:commandButton icon="pi pi-search" />
                                    </div>
                                    <div class="p-field p-col-12 p-md-7">
                                        <label>Tipo Documento</label>

                                    </div>
                                </div>
                                <div class="ui-fluid p-formgrid p-grid">
                                    <div class="p-field p-col-12 p-md-8">
                                        <label>Proveedor</label>

                                        <p:selectOneMenu id="compraProveedorId" tabindex="6" value="#{compraController.proveedor}" required="true" requiredMessage="Debe seleccionar el Proveedor" converter="omnifaces.SelectItemsConverter" filter="true" filterMatchMode="contains">
                                            <f:selectItem itemLabel="Proveedor"/>
                                            <f:selectItems value="#{compraController.proveedorItems}"
                                                           var="compraProveedorIdItem"
                                                           itemValue="#{compraProveedorIdItem}"
                                                           itemLabel="#{compraProveedorIdItem.proveedorNombre}"
                                                           />
                                        </p:selectOneMenu>

                                    </div>
                                    <div class="p-field p-col-12 p-md-1">
                                        <label style="visibility: hidden;">Agregar</label>
                                        <p:commandButton id="createButton" tabindex="-1" icon="pi pi-plus"  actionListener="#{compraController.prepareCreateProveedor}" update=":ProveedorCreateForm" oncomplete="PF('ProveedorCreateDialog').show()" onstart="PF('Loading').show()" onsuccess="PF('Loading').hide()"/>
                                    </div>
                                    <div class="p-field p-col-12 p-md-1">
                                        <label style="visibility: hidden;">Agregar</label>
                                    </div>
                                </div>
                                <div class="ui-fluid p-formgrid p-grid">
                                    <div class="p-field p-col-12 p-md-12">
                                        <label>Glosa</label>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                    <div class="p-col-3">
                        <div class="p-col-12 ">
                            <div class="p-col-10 ">
                                <div class="ui-fluid p-formgrid ">
                                    <div class="p-field p-grid">
                                        <label>Neto</label>
                                    </div>
                                    <div class="p-field p-grid">
                                        <label>Exento</label>
                                        <p:inputNumber id="exento" decimalPlaces="0"  tabindex="9"/>
                                    </div>
                                    <div class="p-field p-grid">
                                        <label>IVA</label>
                                        <p:inputNumber id="iva" decimalPlaces="0"  tabindex="10"/>
                                    </div>
                                    <div class="p-field p-grid">
                                        <label>Otros. Impuestos</label>
                                        <p:inputNumber id="otros" decimalPlaces="0" disabled="true"/>
                                    </div>
                                    <div class="p-field p-grid">
                                        <label>Total</label>
                                        <p:inputNumber id="total" decimalPlaces="0"  disabled="true"/>
                                    </div>
                                </div>
                            </div>                            
                        </div>
                    </div>
                </div>

                <div class="card" >
                    <div class="p-grid">
                        <div class="p-col-2">
                            <p:selectBooleanCheckbox id="checkboxIVAComun" value="#{selectBooleanView.value1}" itemLabel="IVA uso común"/>
                            <p:tooltip for="checkboxIVAComun" value="Monto será asignado automáticamente a la cuenta única IVA" position="right"/>                          
                        </div>
                        <div class="p-col-2">
                            <p:selectBooleanCheckbox id="compraSupermercado" value="#{selectBooleanView.value1}" itemLabel="Compra de supermercado"/>
                        </div>

                        <div class="p-col-2">
                            <p:selectBooleanCheckbox id="sinCF" value="#{selectBooleanView.value1}" itemLabel="Sin derecho CF"/>
                            <p:tooltip for="sinCF" value="Compras sin derecho a crédito fiscal" position="right"/>                          
                        </div>
                        <div class="p-col-2">
                            <p:selectBooleanCheckbox id="ley18211" value="#{selectBooleanView.value1}" itemLabel="Ley N° 18.211"/>
                            <p:tooltip for="ley18211" value="IVA a las importaciones extranjeras" position="right"/>   
                        </div>
                        <div class="p-col-3">
                            <p:selectBooleanCheckbox id="noIncluir" value="#{selectBooleanView.value1}" itemLabel="Compra que no corresponde incluir"/>
                            <p:tooltip for="noIncluir" value="Compras no necesarias para el desarrollo de la actividad" position="right"/>   
                        </div>
                        <div class="p-col-1">
                            <p:selectBooleanCheckbox id="activoFijo" value="#{selectBooleanView.value1}" itemLabel="Es AF"/>
                            <p:tooltip for="activoFijo" value="Compra es un Activo Fijo" position="right"/>   
                        </div>
                    </div>
                </div>




                <div class="p-grid">
                    <div class="p-col-12">
                        <div class="p-col-12 ">
                            <div class="ui-fluid p-formgrid p-grid">
                                <div class="p-field p-col-12 p-md-5">
                                    <label>Cuenta</label>                                    
                                    <p:selectOneMenu id="cuenta" tabindex="11" value="#{compraController.cuentaMayor}" required="true" requiredMessage="Debe seleccionar una Cuenta" converter="omnifaces.SelectItemsConverter" filter="true" filterMatchMode="contains">
                                        <f:selectItem itemLabel="Cuentas"/>
                                        <f:selectItems value="#{compraController.cuentaMayorItems}"
                                                       var="cuenta"
                                                       itemValue="#{cuenta}"
                                                       itemLabel="#{cuenta.cuentaMayorNombre}"
                                                       />
                                    </p:selectOneMenu>
                                </div>
                                <div class="p-field p-col-12 p-md-2">
                                    <label>Monto</label>
                                    <p:inputText placeholder="$ 0" tabindex="12"/>
                                </div>
                                <div class="p-field p-col-12 p-md-4">
                                    <label>Glosa</label>
                                    <p:inputText placeholder="Glosa" tabindex="13"/>
                                </div>
                                <div class="p-field p-col-12 p-md-1">
                                    <label style="visibility: hidden;">Agregar</label>
                                    <p:commandButton value="Agregar" icon="pi pi-plus" styleClass="ui-button-success" />
                                </div>
                            </div>

                        </div>
                        <div class="p-col-3">
                            <p:selectBooleanCheckbox id="contabilizar" value="#{compraController.contabilizar}" itemLabel="Contabilizar?" >
                                <p:ajax update="cuentaContabilidad, fechaContabilidad, tipoPago, numeroDocumentoContabilidad" />
                            </p:selectBooleanCheckbox>
                            <p:tooltip for="contabilizar" value="Habilitar el formulario para Contabilizar" position="right"/>   
                        </div>
                    </div>
                </div>
                <p:divider align="left">
                    <b>Contabilizar</b>
                </p:divider>
                <div class="p-grid">
                    <div class="p-col-12">
                        <div class="p-col-12 ">
                            <div class="ui-fluid p-formgrid p-grid">
                                <div class="p-field p-col-12 p-md-5">
                                    <label>Cuenta</label>                                    
                                    <p:selectOneMenu id="cuentaContabilidad" disabled="#{!compraController.contabilizar}" tabindex="14" value="#{compraController.cuentaMayorContabilidad}" required="true" requiredMessage="Debe seleccionar una Cuenta" converter="omnifaces.SelectItemsConverter" filter="true" filterMatchMode="contains">
                                        <f:selectItem itemLabel="Cuentas"/>
                                        <f:selectItems value="#{compraController.cuentaMayorItemsContabilidad}"
                                                       var="cuenta"
                                                       itemValue="#{cuenta}"
                                                       itemLabel="#{cuenta.cuentaMayorNombre}"
                                                       />
                                    </p:selectOneMenu>
                                </div>
                                <div class="p-field p-col-12 p-md-2">
                                    <label>Fecha</label>
                                    <p:datePicker id="fechaContabilidad" disabled="#{!compraController.contabilizar}" type="text"  tabindex="15" placeholder="F.Documento" showButtonBar="true" />
                                </div>
                                <div class="p-field p-col-12 p-md-2">
                                    <label>Pago en</label>
                                    <p:selectOneMenu id="tipoPago" disabled="#{!compraController.contabilizar}" tabindex="16" value="#{compraController.cuentaMayorContabilidad}" required="true" requiredMessage="Debe seleccionar una Cuenta" converter="omnifaces.SelectItemsConverter" filter="true" filterMatchMode="contains">
                                        <f:selectItem itemLabel="Ninguno" itemValue="1"/>
                                        <f:selectItem itemLabel="Cheque" itemValue="2"/>
                                        <f:selectItem itemLabel="Transferencia" itemValue="3"/>
                                        <f:selectItem itemLabel="Depósito" itemValue="4"/>
                                        <f:selectItem itemLabel="Cargo" itemValue="5"/>
                                        <f:selectItem itemLabel="Abono" itemValue="6"/>
                                        <f:selectItem itemLabel="Efectivo" itemValue="7"/>
                                    </p:selectOneMenu>
                                </div>
                                <div class="p-field p-col-12 p-md-2">
                                    <label>N° Documento</label>
                                    <p:inputNumber id="numeroDocumentoContabilidad" tabindex="17" disabled="#{!compraController.contabilizar}"/>
                                </div>

                            </div>

                        </div>

                    </div>
                </div>
                <p:divider align="left">
                    <b>Detalle</b>
                </p:divider>


            </h:form>

        </p:dialog>
        <p:dialog id="ProveedorCreateDlg" widgetVar="ProveedorCreateDialog" modal="true" resizable="false" appendTo="@(body)" header="Registro Nuevo Proveedor" closeOnEscape="true">

            <h:form id="ProveedorCreateForm">

                <h:panelGroup id="display" rendered="#{compraController.proveedor != null}">
                    <p:panelGrid columns="2" columnClasses="column">

                        <p:outputLabel value="Rut" for="proveedorRut" />
                        <p:inputText id="proveedorRut" value="#{compraController.proveedor.proveedorRut}" title="#{myBundle.CreateProveedorTitle_proveedorRut}" required="true" requiredMessage="#{myBundle.CreateProveedorRequiredMessage_proveedorRut}" size="45" maxlength="45" validator="rutValidatorProveedor"/>

                        <p:outputLabel value="Nombre" for="proveedorNombre" />
                        <p:inputText id="proveedorNombre" value="#{compraController.proveedor.proveedorNombre}" title="#{myBundle.CreateProveedorTitle_proveedorNombre}" required="true" requiredMessage="#{myBundle.CreateProveedorRequiredMessage_proveedorNombre}" size="45" maxlength="45"/>

                        <p:outputLabel value="Giro" for="proveedorGiro" />
                        <p:inputText id="proveedorGiro" value="#{compraController.proveedor.proveedorGiro}" title="#{myBundle.CreateProveedorTitle_proveedorGiro}" size="45" maxlength="45"/>

                        <p:outputLabel value="Dirección" for="proveedorDireccion" />
                        <p:inputText id="proveedorDireccion" value="#{compraController.proveedor.proveedorDireccion}" title="#{myBundle.CreateProveedorTitle_proveedorDireccion}" size="45" maxlength="45"/>

                        <p:outputLabel value="Comuna" for="proveedorComunaId" />
                        <p:selectOneMenu id="proveedorComunaId" value="#{compraController.proveedor.proveedorComunaId}" required="true" requiredMessage="#{myBundle.CreateTrabajadorRequiredMessage_trabajadorIdComuna}" converter="omnifaces.SelectItemsConverter">
                            <f:selectItem itemLabel="#{myBundle.SelectOneMessage}"/>
                            <f:selectItems value="#{comunaController.items}"
                                           var="trabajadorIdComunaItem"
                                           itemValue="#{trabajadorIdComunaItem}"
                                           itemLabel="#{trabajadorIdComunaItem.comunaNombre}"
                                           />

                        </p:selectOneMenu>

                        <p:outputLabel value="Teléfono" for="proveedorTelefono" />
                        <p:inputText id="proveedorTelefono" value="#{compraController.proveedor.proveedorTelefono}" title="#{myBundle.CreateProveedorTitle_proveedorTelefono}" size="45" maxlength="45"/>

                        <p:outputLabel value="Email" for="proveedorEmail" />
                        <p:inputText id="proveedorEmail" value="#{compraController.proveedor.proveedorEmail}" title="#{myBundle.CreateProveedorTitle_proveedorEmail}" size="45" maxlength="45"/>
                    </p:panelGrid>
                    <p:commandButton actionListener="#{compraController.saveNewProveedor}" value="#{myBundle.Save}" update="display,:CompraCreateForm:compraProveedorId,:growl" oncomplete="handleSubmit(xhr,status,args,PF('ProveedorCreateDialog'));">
                        <p:confirm header="#{myBundle.ConfirmationHeader}" message="#{myBundle.ConfirmCreateMessage}" icon="ui-icon-alert"/>
                    </p:commandButton>

                    <p:commandButton value="#{myBundle.Cancel}" oncomplete="PF('ProveedorCreateDialog').hide()" update="display, :CompraCreateForm:compraProveedorId" process="@this" immediate="true" resetValues="true"/>
                </h:panelGroup>

            </h:form>

        </p:dialog>

    </ui:composition>

</html>

